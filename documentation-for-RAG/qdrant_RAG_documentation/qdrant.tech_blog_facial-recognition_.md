---
url: "https://qdrant.tech/blog/facial-recognition/"
title: "Building a Facial Recognition System with Qdrant - Qdrant"
---

0

# Building a Facial Recognition System with Qdrant

David Myriel

·

December 03, 2024

![Building a Facial Recognition System with Qdrant](https://qdrant.tech/blog/facial-recognition/preview/title.jpg)

On this page:

- [Share on X](https://twitter.com/intent/tweet?url=https%3A%2F%2Fqdrant.tech%2Fblog%2Ffacial-recognition%2F&text=Building%20a%20Facial%20Recognition%20System%20with%20Qdrant "x")
- [Share on LinkedIn](https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fqdrant.tech%2Fblog%2Ffacial-recognition%2F "LinkedIn")

# [Anchor](https://qdrant.tech/blog/facial-recognition/\#the-twin-celebrity-app) The Twin Celebrity App

In the era of personalization, combining cutting-edge technology with fun can create engaging applications that resonate with users. One such project is the [**Twin Celebrity app**](https://github.com/neural-maze/vector-twin), a tool that matches users with their celebrity look-alikes using facial recognition embeddings and [**vector search**](https://qdrant.tech/advanced-search/) powered by Qdrant. This blog post dives into the architecture, tools, and practical advice for developers who want to build this app—or something similar.

The [**Twin Celebrity app**](https://github.com/neural-maze/vector-twin) identifies which celebrity a user resembles by analyzing a selfie. The app utilizes:

- **Face recognition embeddings**: Generated by a ResNet-based **FaceNet** model.
- **Vector similarity search**: Powered by Qdrant to find the closest match.
- **ZenML**: For orchestrating data pipelines.
- **Streamlit**: As the front-end interface.

> This project not only demonstrates the capabilities of modern vector databases but also serves as an exciting introduction to embedding-based applications.

* * *

## [Anchor](https://qdrant.tech/blog/facial-recognition/\#learn-from-the-apps-creator) Learn From the App’s Creator

We interviewed the engineer behind this project, [**Miguel Otero Pedrido**](https://www.linkedin.com/in/migueloteropedrido/), who is also the founder of [**The Neural Maze**](https://www.youtube.com/@TheNeuralMaze). Miguel explains in detail how he put the app together, as well as his choice of tools.

Building Facial Recognition Systems with Qdrant - YouTube

Qdrant - Vector Database & Search Engine

7.91K subscribers

[Building Facial Recognition Systems with Qdrant](https://www.youtube.com/watch?v=UJ2jTEBae3A)

Qdrant - Vector Database & Search Engine

Search

Watch later

Share

Copy link

Info

Shopping

Tap to unmute

If playback doesn't begin shortly, try restarting your device.

More videos

## More videos

You're signed out

Videos you watch may be added to the TV's watch history and influence TV recommendations. To avoid this, cancel and sign in to YouTube on your computer.

CancelConfirm

Share

Include playlist

An error occurred while retrieving sharing information. Please try again later.

[Watch on](https://www.youtube.com/watch?v=UJ2jTEBae3A&embeds_referring_euri=https%3A%2F%2Fqdrant.tech%2F&embeds_referring_origin=https%3A%2F%2Fqdrant.tech)

0:00

0:00 / 45:19
•Live

•

[Watch on YouTube](https://www.youtube.com/watch?v=UJ2jTEBae3A "Watch on YouTube")

#### [Anchor](https://qdrant.tech/blog/facial-recognition/\#turns-out-his-celebrity-twin-isandy-samberg) Turns out his celebrity twin is…Andy Samberg

![samberg](https://qdrant.tech/blog/facial-recognition/samberg.png)

* * *

## [Anchor](https://qdrant.tech/blog/facial-recognition/\#architecture) Architecture

**Search Engine & DB:** [**Qdrant**](https://qdrant.tech/) stands out as a high-performance [**vector database**](https://qdrant.tech/qdrant-vector-database/) built in Rust, known for its reliability and speed. Its advanced features, such as [**vector visualization**](https://qdrant.tech/documentation/web-ui/) and efficient [**querying**](https://qdrant.tech/documentation/concepts/search/), make it a go-to choice for developers working on embedding-based projects.

![architecture](https://qdrant.tech/blog/facial-recognition/architecture.png)

**ML Framework:** [**ZenML**](https://www.zenml.io/) simplifies pipeline creation with a modular, cloud-agnostic framework that ensures clean, scalable, and portable code, ideal for cross-platform workflows.

**Facial Recognition:** [**MTCNN**](https://github.com/ipazc/mtcnn#) ensures consistent face alignment, making the embeddings more reliable.

**Embedding Model:** [**FaceNet**](https://github.com/davidsandberg/facenet) provides lightweight, pre-trained facial embeddings, balancing accuracy and efficiency, making it perfect for tasks like the Twin Celebrity app.

**Frontend:** [**Streamlit**](https://github.com/streamlit) streamlines UI development, enabling rapid prototyping with minimal effort, allowing developers to focus on core functionalities.

## [Anchor](https://qdrant.tech/blog/facial-recognition/\#application-workflows) Application Workflows

The app is divided into two phases - **The Offline Phase**, where the celebrity images are vectorized and **The Online Phase**, which carries out a live [**similarity search**](https://qdrant.tech/blog/facial-recognition/).

![online-offline](https://qdrant.tech/blog/facial-recognition/online-offline.png)

**The Offline Phase**

The first step is dataset preparation. Celebrity images are fetched from **HuggingFace’s dataset library** to serve as the foundation for embeddings.

Next - [**MTCNN**](https://github.com/ipazc/mtcnn#) aligns celebrities faces within images.
Then, a pre-trained [**FaceNet**](https://en.wikipedia.org/wiki/FaceNet) model is used to generate 512-dimensional embeddings for each image. This ensures consistent and high-quality representation of facial features.

Finally, these embeddings, along with metadata, are stored in [**Qdrant Cloud**](https://qdrant.tech/cloud/). This enables efficient retrieval and management of the data for later use.

* * *

**The Online Phase**

In the online phase, user interaction begins with a **Streamlit app**. The app captures a selfie and converts it into an embedding using the same FaceNet model.

The generated embedding is then queried against Qdrant, which retrieves the top matches based on similarity.

Finally, the results are displayed in an intuitive interface, showing the user their **closest celebrity match** and making the interaction engaging and seamless.

* * *

## [Anchor](https://qdrant.tech/blog/facial-recognition/\#how-to-build-the-app) How to Build the App

Miguel recently published a video on his YouTube channel: [**The Neural Maze**](https://www.youtube.com/@TheNeuralMaze).

For detailed steps to build the app, watch [**Building a Twin Celebrity App**](https://www.youtube.com/watch?v=LltFAum3gVg).

### [Anchor](https://qdrant.tech/blog/facial-recognition/\#1-set-up-the-offline-pipeline) 1\. Set Up the Offline Pipeline

Using ZenML, the pipeline consists of:

- **Data Loading**: Fetch images and labels (e.g., “Brad Pitt”) from Hugging Face.
- **Sampling**: Reduce dataset size for faster processing, selecting around 3,000 images.
- **Embedding Generation**: Convert images into embeddings using MTCNN for face detection and FaceNet for embedding creation.
- **Storage in Qdrant**: Save embeddings into a collection named `celebrities`.

### [Anchor](https://qdrant.tech/blog/facial-recognition/\#2-create-the-online-application) 2\. Create the Online Application

The Streamlit app handles:

- **Image Capture**: Takes a selfie through a webcam or uploaded file.
- **Embedding Querying**: Sends the embedding to Qdrant, retrieves the top matches, and visualizes the similarity.

### [Anchor](https://qdrant.tech/blog/facial-recognition/\#3-deployment-options) 3\. Deployment Options

- Deploy the app on platforms like **Google Cloud**, **AWS**, or **Azure**. Setting up CI/CD pipelines can streamline updates and deployments.

- The application can be containerized using **Docker**. For hosting, **Google Cloud Run** is an excellent choice, as it efficiently manages containerized applications without requiring extensive infrastructure management.

- The deployment process is streamlined further with CI/CD pipelines, such as those provided by **Cloud Build or GitHub Actions**, which automate the steps for building, testing, and deploying updates.


### [Anchor](https://qdrant.tech/blog/facial-recognition/\#4-test-the-quality-of-your-embeddings) 4\. Test the Quality of Your Embeddings

You can always use [**Qdrant’s visualization tools**](https://qdrant.tech/documentation/web-ui/) to refine accuracy and ensure clusters align with expectations.

![architecture](https://qdrant.tech/blog/facial-recognition/web-ui.png)

If your data is properly embedded, then the visualization tool will appropriately cluster celebrity images into groups.

* * *

## [Anchor](https://qdrant.tech/blog/facial-recognition/\#lessons-and-takeaways) Lessons and Takeaways

Scalability poses challenges when working with large datasets, such as 20,000+ images. Consider optimizations like [**quantization**](https://qdrant.tech/documentation/guides/quantization/) to reduce memory usage or precomputing average embeddings for clusters can significantly minimize storage and computational costs. These strategies ensure the system remains performant as the dataset grows.

The potential real-world applications of this technology extend far beyond entertainment. Similar systems can be used in security applications for embedding-based facial recognition to secure access to buildings or devices.

In **healthcare**, they can assist in analyzing features such as moles or skin textures. In **retail**, they enable personalized recommendations based on user photos, demonstrating the versatility of this approach.

* * *

## [Anchor](https://qdrant.tech/blog/facial-recognition/\#next-steps-for-developers) Next Steps for Developers

- Start by [**cloning the project repository**](https://github.com/neural-maze/vector-twin) to understand the architecture and functionality.

- Expand the dataset with more celebrity images for diversity or fine-tune the FaceNet model for improved accuracy.

- Consider deploying a mobile-friendly version using frameworks like **Flutter** or **React Native** for a seamless user experience.


> For scalability, implement **multi-GPU setups** to speed up embedding generation and optimize storage with techniques like quantization or average embeddings.

To enhance functionality, explore features like **video input for real-time matches** or add **metadata such as celebrity bios** to enrich user interaction. Experiment with custom similarity scoring for more tailored results.

## [Anchor](https://qdrant.tech/blog/facial-recognition/\#more-links) More Links

- Miguel’s [LinkedIn profile](https://www.linkedin.com/in/migueloteropedrido/)
- Miguel’s [Substack blog](https://theneuralmaze.substack.com/)
- The Neural Maze [YouTube channel](https://www.youtube.com/@TheNeuralMaze)
- Twin Celebrity [GitHub Repository](https://github.com/neural-maze/vector-twin)

### Get Started with Qdrant Free

[Get Started](https://cloud.qdrant.io/signup?ajs_anonymous_id=e18ca35d-465d-477e-bb29-e1704487348b)

![](https://qdrant.tech/img/rocket.svg)

Up!

![Company Logo](https://cdn.cookielaw.org/logos/static/ot_company_logo.png)

## Privacy Preference Center

Cookies used on the site are categorized, and below, you can read about each category and allow or deny some or all of them. When categories that have been previously allowed are disabled, all cookies assigned to that category will be removed from your browser.
Additionally, you can see a list of cookies assigned to each category and detailed information in the cookie declaration.


[More information](https://qdrant.tech/legal/privacy-policy/#cookies-and-web-beacons)

Allow All

### Manage Consent Preferences

#### Targeting Cookies

Targeting Cookies

These cookies may be set through our site by our advertising partners. They may be used by those companies to build a profile of your interests and show you relevant adverts on other sites. They do not store directly personal information, but are based on uniquely identifying your browser and internet device. If you do not allow these cookies, you will experience less targeted advertising.

#### Functional Cookies

Functional Cookies

These cookies enable the website to provide enhanced functionality and personalisation. They may be set by us or by third party providers whose services we have added to our pages. If you do not allow these cookies then some or all of these services may not function properly.

#### Strictly Necessary Cookies

Always Active

These cookies are necessary for the website to function and cannot be switched off in our systems. They are usually only set in response to actions made by you which amount to a request for services, such as setting your privacy preferences, logging in or filling in forms. You can set your browser to block or alert you about these cookies, but some parts of the site will not then work. These cookies do not store any personally identifiable information.

#### Performance Cookies

Performance Cookies

These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site. They help us to know which pages are the most and least popular and see how visitors move around the site. All information these cookies collect is aggregated and therefore anonymous. If you do not allow these cookies we will not know when you have visited our site, and will not be able to monitor its performance.

Back Button

### Cookie List

Search Icon

Filter Icon

Clear

checkbox labellabel

ApplyCancel

ConsentLeg.Interest

checkbox labellabel

checkbox labellabel

checkbox labellabel

Reject AllConfirm My Choices

[![Powered by Onetrust](https://cdn.cookielaw.org/logos/static/powered_by_logo.svg)](https://www.onetrust.com/products/cookie-consent/)

![](https://t.co/1/i/adsct?bci=4&dv=America%2FAdak%26en-US%2Cen%26Google%20Inc.%26Linux%20x86_64%26255%261280%261024%264%2624%261280%261024%260%26na&eci=3&event=%7B%7D&event_id=923f1888-ea49-4cb4-9942-129446e62075&integration=advertiser&p_id=Twitter&p_user_id=0&pl_id=9285f015-2c43-4959-ad0b-041a56fd0da9&tw_document_href=https%3A%2F%2Fqdrant.tech%2Fblog%2Ffacial-recognition%2F&tw_iframe_status=0&txn_id=o81g6&type=javascript&version=2.3.33)![](https://analytics.twitter.com/1/i/adsct?bci=4&dv=America%2FAdak%26en-US%2Cen%26Google%20Inc.%26Linux%20x86_64%26255%261280%261024%264%2624%261280%261024%260%26na&eci=3&event=%7B%7D&event_id=923f1888-ea49-4cb4-9942-129446e62075&integration=advertiser&p_id=Twitter&p_user_id=0&pl_id=9285f015-2c43-4959-ad0b-041a56fd0da9&tw_document_href=https%3A%2F%2Fqdrant.tech%2Fblog%2Ffacial-recognition%2F&tw_iframe_status=0&txn_id=o81g6&type=javascript&version=2.3.33)

![Sifted-Announcement-1B](https://139603372.fs1.hubspotusercontent-eu1.net/hub/139603372/hubfs/Sifted-Announcement-1B.jpg?width=567&height=296&name=Sifted-Announcement-1B.jpg)

## Enjoying this blog?

Subscribe to our monthly newsletter to receive the latest resources and updates.

Email\*

By submitting, you agree to subscribe to Qdrant's updates. You can withdraw your consent anytime. More details are in the [Privacy Policy](https://qdrant.tech/legal/privacy-policy/?webInteractiveId=620271994043&webInteractiveContentId=237919561943&containerType=MODAL&pageUrl=https%3A%2F%2Fqdrant.tech%2Fblog%2Ffacial-recognition%2F&portalId=139603372&pageTitle=Building+a+Facial+Recognition+System+with+Qdrant+-+Qdrant&referrer=&userAgent=Mozilla%2F5.0+%28X11%3B+Linux+x86_64%29+AppleWebKit%2F537.36+%28KHTML%2C+like+Gecko%29+Chrome%2F137.0.0.0+Safari%2F537.36&hutk=8ec8216daf6d01dafc361fa5d7721548&hssc=265983056.1.1748573798350&hstc=265983056.8ec8216daf6d01dafc361fa5d7721548.1748573798350.1748573798350.1748573798350.1&hsfp=3707738794).

Submit

## By submitting, you agree to subscribe to Qdrant’s updates. You can withdraw your consent anytime. More details are in the [Privacy Policy](https://cta-eu1.hubspot.com/web-interactives/public/v1/track/click?encryptedPayload=AVxigLK8Tz%2FEDKnDiKMvegOsr1Pu5ZW3Y%2BUmdM4RyrsMZ01kzRaG4iGViyAmaI7I0a6DlEJufA4usCQ%2BxO6TSO%2Bk2FVeACGpI5rvmiWNP%2BBHMuHXSj4KbzGIkv3FQ7k1MC284J7R&portalId=139603372&webInteractiveId=620271994043&webInteractiveContentId=237919561943&containerType=MODAL&pageUrl=https%3A%2F%2Fqdrant.tech%2Fblog%2Ffacial-recognition%2F&pageTitle=Building+a+Facial+Recognition+System+with+Qdrant+-+Qdrant&referrer=&userAgent=Mozilla%2F5.0+%28X11%3B+Linux+x86_64%29+AppleWebKit%2F537.36+%28KHTML%2C+like+Gecko%29+Chrome%2F137.0.0.0+Safari%2F537.36&hutk=8ec8216daf6d01dafc361fa5d7721548&hssc=265983056.1.1748573798350&hstc=265983056.8ec8216daf6d01dafc361fa5d7721548.1748573798350.1748573798350.1748573798350.1&hsfp=3707738794).